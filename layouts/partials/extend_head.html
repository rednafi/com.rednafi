{{- /* Preconnect to external domains for better performance */ -}}
<link rel="preconnect" href="https://blob.rednafi.com" crossorigin>
<link rel="dns-prefetch" href="https://blob.rednafi.com">

{{- /* Temporary: Testing fonts - remove when moving to self-hosted */ -}}
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap" rel="stylesheet">

{{- /* Preconnect to Google Analytics */ -}}
{{- if site.Config.Services.GoogleAnalytics.ID -}}
<link rel="preconnect" href="https://www.googletagmanager.com" crossorigin>
<link rel="dns-prefetch" href="https://www.googletagmanager.com">
{{- end -}}

{{- /* Preload critical fonts - only Inter (body text), JetBrains Mono loads on demand for code blocks */ -}}
<link rel="preload" href="/fonts/inter-latin.woff2" as="font" type="font/woff2" crossorigin="anonymous">

{{- /* Conditional preconnect for mermaid CDN */ -}}
{{- if .Params.mermaid }}
<link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>
<link rel="dns-prefetch" href="https://cdn.jsdelivr.net">
{{- end }}

{{- /* Speculation Rules for instant navigation (Chromium browsers) */ -}}
<script type="speculationrules">
{
  "prefetch": [{
    "where": { "and": [
      { "href_matches": "/*" },
      { "not": { "href_matches": "/search/*" } }
    ]},
    "eagerness": "moderate"
  }],
  "prerender": [{
    "where": { "and": [
      { "href_matches": "/*" },
      { "not": { "href_matches": "/search/*" } },
      { "not": { "selector_matches": "[rel~=external]" } }
    ]},
    "eagerness": "conservative"
  }]
}
</script>
